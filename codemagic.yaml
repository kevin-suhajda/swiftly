workflows:
    ios-swiftly:
      name: ios_swiftly
      environment:
        vars:
          XCODE_WORKSPACE: "swiftly.xcworkspace"
          XCODE_SCHEME: "swiftly"
          BUNDLE_ID: "io.codemagic.swiftly"
          APP_STORE_CONNECT_ISSUER_ID: Encrypted(Z0FBQUFBQmZtQUdYenNMbHBZbk55LU9OUFViVmktNmVWaVVncS1ySzlMQWFCLU9EZEI5Q00waDBUSGo3M21LMmp6R3l0dFJSaDlXdDRQbHk4cmZJRGNDc1A1NmJ2ZDd1d2J6SzNoM1NXYVo3SjlPUTE1ZFh2YjRBS0c0VDR1bWhWaEl4d1RJdXBzSzk=)
          APP_STORE_CONNECT_KEY_IDENTIFIER: Encrypted(Z0FBQUFBQmZtQUc3Mk1jbjhnaGFrUFdCV3dLUjg5aWgtZ1NCME5HV29uWWlYSTQxOFgtcVB4UUg1Y25pRkNxMkpvUllOMGNqUjVVbFZhVl9vU2lqTGZ3R29WVGNwOUY4QWc9PQ==)
          APP_STORE_CONNECT_PRIVATE_KEY: Encrypted(Z0FBQUFBQmZtQUxCZGhyY3Y4ZHFGT0YtMkNUbTNhUmtWNTc1TjY3aVZyMmxyemVjelJKV0czeURFd2tBMzRFdW1FRW85bjcxakw0RmJzLUEyMy1BZGZLZFZ6N2dVMEZzQ0d6NkxwLV9qZFdZSndRLU9VRi1kZTJKaldPM2ZISnhiTDdxVDFPQmxRVm4tdk5Ub2dDdElvdkY0dHcxNXBPMVJnWWxmQzZ5NzVOaWZVZzRBdkpWUjdwNVdmaEU0U3BJWkhRLTBsVUtVNnllX3E0Rm1WS2JZWDBrcC1KSl95Rjd0R0N2bnNlSnJ0VXAxc1Q5NXJ5cDNMRzRKeFpnSWlRTDdWWl9nb2NCcGN2aGU3S2FzVmVwQ1VaWDRESUhxYWJiekU3SnYxRFJZYXR3TU1lOWhId0hRaDhhWUdjekJmb1ZBdmVmV0hoeEp2RHQxVXQwTVluVjRGbGdjOXpkb01NSDFqRVpxa2NQNDZGUE1Sby1sMEM2RWdIUjk0MVRaVzQyZW1QQTU2QTZ6MTRFa2pGMXJjSERnVlZrTGZRT1ZVank3eXpYUDhtTmJ6dmpQbGF2Q2JHei05Zz0=)
          CERTIFICATE_PRIVATE_KEY: Encrypted(Z0FBQUFBQmZtQU0wN0pFbXdrTm93Nzd1R1BnVi1uTG50LUJHS1VpYy1ucDAzTFowWm1zNkw3RkRLdDMzNlJNN2FaQTZodFV0Vkx6QkZtdUwwbDRWeVJvRnJTcjVTZFF4ci1QUDdCZnhySGI0ODRqOU5kRThvZUFNR2docEJaNVFoS2pBTUhTbFpWWFdKMWNjZXFOM2ZSb2s2TDhZVE5GSWEzRmkxNkt1eDFaX2J0YU5wVFY2cnQtUzZRblZ1Y2ZidkFpQTgxbHpNbzRLc0ZVdnpJSG5JZXpKcU4wejZDQmlwWkozRV9pc1ZhTDlxU2l2NHRvbkJ0c0ZnV3hRN2Z6T2g0bUJ4ZDI4bGYtay0yUXBhUFpYUVF5VUFESV9LdUVmVVBHM0d4ZDlMdW1NbFNMNFg3SXZJU2ljODY1OVNMbUJfaW9tcThNVHdBTUpQbFVHWUJXMVdDWlNkampadVhJRjZIa0ZmSnRZeW1JVk5hZXp6OTZ4em1sM045UUJuYWZRb0Z0RlpvbFFLMkY2MUtJQW44Tzh2UE5DNU9sLUNFd3lYU25ndDlza29kVHM0XzZoY3R2SVFkcmxkSGxkbFBnOVI0YlZQTHUwdVVYUl8xaDl5cWYyb0o4c0Y5RW9taUxWVWZDNlB4V2dESlZxb3dpalg3UlpqOVhFN2ZlYzNwOXgtRHU1OVR3d2NGZnhLRUtxVE1YaFdzOTluVkZSQ0NjZ1lIc1NxLUx3ZWlldl96YnZhMVduM2dvNFdVWDJhZE5xWXlXSWFVb2JQaWR6cHg5SmhPZFlhS1NkU3lyUG0wQWFsY3BRMDNncHFiV1lraWYta1loTFJWTW4wNWZRY1RFR1YxVDRiWWNBUkdSSjZ3S2xsQTQ2SUFUQ1dNMnpUUzRncWluYWxKdnpBM05vOXgxSEdqb2JRcHBVbzduQTJtY1YyNlp6ZUpjTExpdE5HLUdxSFVTenhnSWg4S1hpM3hfRFRFeXVhZE5NWURsTl9LMkgwU3Y1UEc5Y1N0ZVU5bVk2Qmt4T244Tk45Tk5iZC1nSmZZUzdNemFtczdTa1FybXZCUE4wQmNkaEpkY2pHWUw2MUNIbV9rc092Q202TzRhWl8tSU5aTVhMSEhXVVY0QjJWVmZFZWppMjdYb3ROSlQwUU5WN1d2cm1mNjZkOXY2RE5aNUs0ZHNLbEdXUHB1WG5fT05QQ3VKNzNvQkFpN3Q5V2x4aWxRUm12cFBHZC12STJXZkJ3Uld4TVYtMEVySkhRNnloVko0ZmVBZVNHd1hjYjdMT0NBNWR3dnliMzFhVTJ6V3FlRUFhNlFYbjNqeFRMZ19TN2NfQWl0S09FMktZTFN2WHNtRG0yYVZ0dVVZaWRzUWN2eG9FYlpRMWJKQW12dVJ1M0pNelRscUZ3d3ZoRndiRUJDMGIzZDFsUFlwaXd4VDRZekIyZElrRnNCeExjR0tCMTFSOTIzU29GRFNwUG1jZ3pNVjVZU3YwTmp3SHY1UllSU1kyZW5RQWx1dC1qWEdHYm9QdXZOQjFJWnNFd0pwekR6TzNPRmJKMjZpNUVydm5DMEJLdnVZQkdOOEhyVG92cUJTLTNlTmVYeGloS3RYSE43RFpIZEZMN1JtdzVkbk82eEVHMWpGRGhFckQyaGZJdWg5RS1zY3IzZG9NanVQbDVRWDZaRVVEekhnazJhVUZIN1A5OGlkcEd4WFdwblRWYzM4eWl4R1BUT1Z6bnBqMFdKUUpiUk1VdlBYU0MyRUl3YkZzcHROcTJaRFNsYlEyeG1aX2U5eTlESjlTenpXeDQwWDRfSzc3TXJvLWJEemVOVHB0TFhrdkJoR1l4dXQ3TlBBak4wZzVOc0M2VjdpaUJGZW80RTg2YkZwQnd1X2tYRVpINjducDhaTGdJVW05UEw4c3Z3WWU2RlBPX3c1WTdxZGZ0VVhoeDRlemZNQVM5Rk1qekFsYjRBWExxaWNMNVVTZ2FfVjRYY0ttYXpZX1ZYR0UteFNidk5PQXJDNkpkeDBGb1M5NVNYZmtqRkIwMm4tTFJnaFo4cW5DMDJRXzlBZVhJWlZYWXNyRHkwdmZKdzhXSGgtVUFVdDBNX25BNFFaMktxZno2ZVMxWEEzaGtyellrZUY5d3FuRHFuM0pVNjQwbnJMZjMxbzU3NDZ5a0xpZzg2ckowRVIzakJpbE5IVHBOME9pVW1fYzh4aVBpREZCcUhMS25WRnRudWh3UldrZXFwbmpGeUUwWWs3M01EcTVGTXM2TFhtSTJzOUtlTkM4SHNzNXh1ZXUxQ0V3XzM5a0c0aURhTzZRZnd3X09FZGxOY0hDcDlINXBEa2hpUVdpMUU5ZlM3MWFnMmdqbFhMd29HTXRHOGlsMFdoNzlhYTBkb2h2UUg0ejNxX2M2bWdhSDcyNjFqZ0FtRkNlY3hWZkVLdlBQTFdDYjZPUGNfanhQWmNCYmVfM051Z0F3cWlPQ1ZKZlp2X3hVMkZiVzh4YTB2dUdReXlJX0YwOUZoVDBiUnZxR3c4VkR1SDVWcFhJSXRJc3ZGZnkzR3FQU3hhRTRkQWlGcC16Umw5aGFDVmw2YnR5dUZuOTJmWkZ3cURpaE04a0pjazQ5cVZ1SmdPTFdsTFkwMGxXemlOY0JqU2lRS3RRM3kybXdPVTJ5TzVQdU10QjJqcV81SmV0RkJzWHg1RzdBVjFQa1dURkw2ZDVPVkNlNVIzN1dzUXdXWnJtbWZYTnFIS1VxV3UzS0hJNmxyMk9wTkZHdHJUODBuRjVVZmp4NENGckh5djB3VEc1U2d4V3BrZ05QSGg0SXhndjN2RkszY1dOd29EMXhoYld5LXMtaVEtNmNjb0hNUzdRTWMyZ2dXa0JuNG4xZHNnUEJzbkY4U1dpLUEyUF84RjI1SFpvRmhfTVJUdnJBQXVyc2NGemlWVzRweUFkY2V5anJqRWN5X2lXUE43cDJzNzlzOUdQUDNPaDVEcnVIMlRNZEx0THdDNE5yd005SHlUTUNRU1JQWWpDU0VYOVhUR2VsSVFjYmcydnBwbUxuOWNrMEQ0bENJa2w5eF9wZURKV3ozeHVPZFRhdmFHcTI4bHBjRTBh)
        xcode: latest
        cocoapods: default
      triggering:
        events:
          - push
          - tag
          - pull_request
        branch_patterns:
          - pattern: 'develop'
            include: true
            source: true
      scripts:
        - name: Set up keychain to be used for codesigning using Codemagic CLI 'keychain' command
          script: |
            keychain initialize
        - name: Fetch signing files
          script: |
            app-store-connect fetch-signing-files $BUNDLE_ID --type IOS_APP_STORE --create
        - name: Use system default keychain
          script: |
            keychain add-certificates
        - name: Set up code signing settings on Xcode project
          script: |
            xcode-project use-profiles
        - name: Increment build number
          script: |
            #!/bin/sh
            set -e
            set -x
            cd $FCI_BUILD_DIR
            agvtool new-version -all $(($BUILD_NUMBER + 1))
        - name: Build ipa for distribution
          script: |
            xcode-project build-ipa --workspace "$XCODE_WORKSPACE" --scheme "$XCODE_SCHEME"
      artifacts:
        - build/ios/ipa/*.ipa
        - $HOME/Library/Developer/Xcode/DerivedData/**/Build/**/*.dSYM
      publishing:
        app_store_connect:                 
          apple_id: suhajda.kevin.ferenc@gmail.com   
          password: Encrypted(Z0FBQUFBQmZtQmhXUngzTVEzekxTeW1CMFg2bV9vdXR1Q3hyZUliNEs4QjRibDZucjJITVI0bkV6WXZCMk5VcmxhcExNNFgzdjZuLUpmNldDZktmd1RuamJhUVkxUGpXcEZwVVh2VkFLUktvNE1hSjdkVUJ2N3M9)
        email:
            recipients:
            - kevin@nevercode.io
